#!/bin/zsh

# –¶–≤–µ—Ç–∞ –¥–ª—è —Ç–µ—Ä–º–∏–Ω–∞–ª–∞
green='\033[0;32m'
blue='\033[0;34m'
nc='\033[0m'

# 1. –°–ø—Ä–∞—à–∏–≤–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã
echo -n "–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, Node.js): "
read DISC_NAME

# –£–±–∏—Ä–∞–µ–º –ø—Ä–æ–±–µ–ª—ã –¥–ª—è –Ω–∞–∑–≤–∞–Ω–∏–π —Ñ–∞–π–ª–æ–≤
DISC_ID=${DISC_NAME// /_}
DIR_PATH="$DISC_ID"

# 2. –°–æ–∑–¥–∞–µ–º –ø–∞–ø–∫—É
mkdir -p "$DIR_PATH"

# 3. –ú–∞—Å—Å–∏–≤ —Å –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –±–ª–æ–∫–æ–≤ (–¥–ª—è —ç—Ç–∞–ª–æ–Ω–Ω–æ–≥–æ Obsidian)
blocks=(
  "–í–≤–µ–¥–µ–Ω–∏–µ –∏ –û—Å–Ω–æ–≤—ã"
  "–§—É–Ω–∫—Ü–∏–∏ –∏ –û–±—ä–µ–∫—Ç—ã"
  "–†–∞–±–æ—Ç–∞ —Å DOM –∏ –°–æ–±—ã—Ç–∏—è"
  "–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å –∏ –î–∞–Ω–Ω—ã–µ"
  "–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –û—Å–Ω–æ–≤—ã –∏ –û—à–∏–±–∫–∏"
  "–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å –∏ –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ä–∏–π"
  "–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ –î–µ–ø–ª–æ–π"
)

# 4. –°–æ–∑–¥–∞–µ–º MOC —Ñ–∞–π–ª
MOC_FILE="$DIR_PATH/${DISC_ID}-moc.md"
cat <<EOF > "$MOC_FILE"
---
discipline: $DISC_NAME
type: MOC
status: üü° –í –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ
pillars: 7_pillars_enabled
---

# üó∫ –ö–∞—Ä—Ç–∞ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã: $DISC_NAME

## üìä –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ (–ê–Ω–∞–ª–∏–∑ –∏ –ê—É–¥–∏—Ç)
\`\`\`dataview
TABLE status as "–°—Ç–∞—Ç—É—Å", duration as "–ó–∞—Ç—Ä–∞—á–µ–Ω–æ (–º–∏–Ω)", count(file.tasks) as "–ó–∞–¥–∞—á –æ—Å—Ç–∞–ª–æ—Å—å"
FROM "$DIR_PATH"
WHERE type = "module"
SORT module_id ASC
\`\`\`

## üèó –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —Ü–µ–ø–æ—á–∫–∞
EOF

# 5. –¶–∏–∫–ª —Å–æ–∑–¥–∞–Ω–∏—è 10 –º–æ–¥—É–ª–µ–π
for i in {0..9}; do
  FILE_NAME="${DISC_ID}-m$i.md"
  BLOCK_TITLE=${blocks[$((i+1))]}

  # –î–æ–±–∞–≤–ª—è–µ–º —Å—Å—ã–ª–∫—É –≤ MOC
  echo "$((i)). [[$FILE_NAME]] ‚Äî $BLOCK_TITLE" >> "$MOC_FILE"

  # –°–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª –º–æ–¥—É–ª—è
  cat <<EOF > "$DIR_PATH/$FILE_NAME"
---
type: module
module_id: m$i
discipline: $DISC_NAME
status: üî¥ Todo
duration: 0
---

# $BLOCK_TITLE

## üîÑ –¶–∏–∫–ª—ã –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è (–ø–æ [[learning-technology]])
- [ ] **C1: –ú–µ—Ö–∞–Ω–∏–∫–∞** (3 –ø—Ä–æ–≥–æ–Ω–∞) | –ü–ª–∞–Ω: D0 | –§–∞–∫—Ç:
- [ ] **C2: –í—Å–ª–µ–ø—É—é** (2 –ø—Ä–æ–≥–æ–Ω–∞) | –ü–ª–∞–Ω: D1 | –§–∞–∫—Ç:

## üìö 1. –¢–µ–æ—Ä–∏—è (10%)
- [ ] –ö–æ–Ω—Å–ø–µ–∫—Ç –∏–∑ –ø–µ—Ä–≤–æ–∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.

## üî® 2. –î—Ä–æ—á–∫–∞ (Drills) (80%)
- [ ] –ó–∞–¥–∞—á–∞ 1
- [ ] –ó–∞–¥–∞—á–∞ 2

## üèó 3. –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ –∑–∞–¥–∞—á–∏ (–°–±–æ—Ä–∫–∞)
- [ ] –§–∏–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –±–ª–æ–∫–∞.

## üìä –†–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ (Lessons Learned)
EOF
done

echo "${green}–ú–∞–Ω—É—Ñ–∞–∫—Ç—É—Ä–∞ –¥–ª—è $DISC_NAME —É—Å–ø–µ—à–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞ –≤ $DIR_PATH${nc}"
